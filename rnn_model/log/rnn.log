Using gpu device 0: GeForce GTX TITAN X (CNMeM is disabled, cuDNN 5103)
Preparing data...
Building model...
Training...
Epoch 0
Epoch 0 Update 5 Cost 121.212437767 Time 1.73132491112 Samples 100
Epoch 0 Update 10 Cost 82.7270392178 Time 3.26866984367 Samples 100
Epoch 0 Update 15 Cost 76.6500599335 Time 4.74760699272 Samples 100
Epoch 0 Update 20 Cost 77.9793852487 Time 6.29593491554 Samples 100
Epoch 0 Update 25 Cost 70.3722434342 Time 7.75578594208 Samples 100
Epoch 0 Update 30 Cost 60.1525399379 Time 9.2613928318 Samples 100
Epoch 0 Update 35 Cost 63.9351380776 Time 10.8258328438 Samples 100
Epoch 0 Update 40 Cost 67.5408596705 Time 12.2093029022 Samples 100
Epoch 0 Update 45 Cost 65.0753977265 Time 13.7510719299 Samples 100
Epoch 0 Update 50 Cost 65.0258187968 Time 15.2152168751 Samples 100
Epoch 0 Update 55 Cost 60.1582252204 Time 16.6944060326 Samples 100
Epoch 0 Update 60 Cost 64.6186993539 Time 18.3090379238 Samples 100
Epoch 0 Update 65 Cost 64.5413753252 Time 19.7816209793 Samples 100
Epoch 0 Update 70 Cost 58.0007534627 Time 21.4307479858 Samples 100
Epoch 0 Update 75 Cost 58.4520827044 Time 22.833523035 Samples 100
Epoch 0 Update 80 Cost 53.7358637056 Time 24.4747459888 Samples 100
Epoch 0 Update 85 Cost 58.9235654729 Time 26.0660719872 Samples 100
Epoch 0 Update 90 Cost 61.1009329713 Time 27.4657838345 Samples 100
Epoch 0 Update 95 Cost 63.2090950917 Time 28.9937889576 Samples 100
Epoch 0 Update 100 Cost 54.6012056853 Time 30.5753018856 Samples 100
Epoch 0 Update 105 Cost 57.65783603 Time 32.1075379848 Samples 100
Epoch 0 Update 110 Cost 55.7265548746 Time 33.6046969891 Samples 100
Epoch 0 Update 115 Cost 49.3280838469 Time 34.9628789425 Samples 100
Epoch 0 Update 120 Cost 69.3081875529 Time 36.5892219543 Samples 100
Epoch 0 Update 125 Cost 56.817115013 Time 37.9975588322 Samples 100
Epoch 0 Update 130 Cost 49.4462317165 Time 39.4939749241 Samples 100
Epoch 0 Update 135 Cost 59.2992676986 Time 41.0456008911 Samples 100
Epoch 0 Update 140 Cost 59.59667807 Time 42.3869998455 Samples 100
Epoch 0 Update 145 Cost 50.2055064457 Time 43.7704269886 Samples 100
Epoch 0 Update 150 Cost 49.7807087924 Time 45.4533908367 Samples 100
Epoch 0 Update 155 Cost 50.1589341666 Time 46.9043140411 Samples 100
Epoch 0 Update 160 Cost 66.0023906004 Time 48.4194319248 Samples 100
Epoch 0 Update 165 Cost 50.3857766383 Time 49.9935770035 Samples 100
Epoch 0 Update 170 Cost 49.8736707505 Time 51.4715900421 Samples 100
Epoch 0 Update 175 Cost 51.5281089658 Time 53.108276844 Samples 100
Epoch 0 Update 180 Cost 52.0336179528 Time 54.7243168354 Samples 100
Epoch 0 Update 185 Cost 43.3059919969 Time 56.3859539032 Samples 100
Epoch 0 Update 190 Cost 49.0926807953 Time 58.0055148602 Samples 100
Epoch 0 Update 195 Cost 60.2933063327 Time 59.6189088821 Samples 100
Epoch 0 Update 200 Cost 53.9372536101 Time 61.0473468304 Samples 100
Epoch 0 Update 205 Cost 50.2918326829 Time 62.473418951 Samples 100
Epoch 0 Update 210 Cost 52.620002865 Time 63.8982489109 Samples 100
Epoch 0 Update 215 Cost 47.0410326114 Time 65.5408480167 Samples 100
Epoch 0 Update 220 Cost 46.5841910862 Time 67.0236048698 Samples 100
Epoch 0 Update 225 Cost 37.653200393 Time 68.4495429993 Samples 100
Epoch 0 Update 230 Cost 46.9285015517 Time 70.0016989708 Samples 100
Epoch 0 Update 235 Cost 50.6848261448 Time 71.4068918228 Samples 100
Epoch 0 Update 240 Cost 46.979067528 Time 72.9405138493 Samples 100
Epoch 0 Update 245 Cost 56.1526088693 Time 74.4781279564 Samples 100
Epoch 0 Update 250 Cost 51.471783275 Time 76.051530838 Samples 100
Epoch 0 Update 255 Cost 49.2348193985 Time 77.4462640285 Samples 100
Epoch 0 Update 260 Cost 40.9884959233 Time 78.8147418499 Samples 100
Epoch 0 Update 265 Cost 49.4073602969 Time 80.2542219162 Samples 100
Epoch 0 Update 270 Cost 48.1127052624 Time 81.6416950226 Samples 100
Epoch 0 Update 275 Cost 49.9443192041 Time 83.1128308773 Samples 100
Epoch 0 Update 280 Cost 47.9343619435 Time 84.6811070442 Samples 100
Epoch 0 Update 285 Cost 55.2368972378 Time 86.0936830044 Samples 100
Epoch 0 Update 290 Cost 50.1496598477 Time 87.5274839401 Samples 100
Epoch 0 Update 295 Cost 43.6497723477 Time 89.0693039894 Samples 100
Epoch 0 Update 300 Cost 47.9205675429 Time 90.5756280422 Samples 100
Epoch 0 Update 305 Cost 48.7814903778 Time 92.0925610065 Samples 100
Epoch 0 Update 310 Cost 46.497086935 Time 93.5089468956 Samples 100
Epoch 0 Update 315 Cost 45.3178736567 Time 94.9953439236 Samples 100
Epoch 0 Update 320 Cost 46.1749301157 Time 96.43531394 Samples 100
Epoch 0 Update 325 Cost 52.4750839605 Time 97.9830739498 Samples 100
Epoch 0 Update 330 Cost 44.1338776269 Time 99.4464030266 Samples 100
Epoch 0 Update 335 Cost 46.4004699688 Time 100.982658863 Samples 100
Epoch 0 Update 340 Cost 46.3986017544 Time 102.451438904 Samples 100
Epoch 0 Update 345 Cost 47.4113427941 Time 103.900344849 Samples 100
Epoch 0 Update 350 Cost 47.6260485877 Time 105.372666836 Samples 100
Epoch 0 Update 355 Cost 43.4607026977 Time 106.872444868 Samples 100
Epoch 0 Update 360 Cost 38.147408041 Time 108.385308981 Samples 100
Epoch 0 Update 365 Cost 46.781679047 Time 109.864073992 Samples 100
Epoch 0 Update 370 Cost 44.2332146111 Time 111.335417032 Samples 100
Epoch 0 Update 375 Cost 43.2117383135 Time 112.636481047 Samples 100
Epoch 0 Update 380 Cost 49.6341178303 Time 114.119045973 Samples 100
Epoch 0 Update 385 Cost 36.5194572531 Time 115.673403978 Samples 100
Epoch 0 Update 390 Cost 40.7674882926 Time 117.64291501 Samples 100
Epoch 0 Update 395 Cost 43.0367109399 Time 119.553979874 Samples 100
Epoch 0 Update 400 Cost 44.063904453 Time 121.38310194 Samples 100
Epoch 0 Update 405 Cost 43.2305899839 Time 123.343590975 Samples 100
Epoch 0 Update 410 Cost 40.6780132686 Time 124.829397917 Samples 100
Epoch 0 Update 415 Cost 45.1305025965 Time 126.909931898 Samples 100
Epoch 0 Update 420 Cost 39.1311592285 Time 128.816448927 Samples 100
Epoch 0 Update 425 Cost 54.7752010129 Time 130.258080959 Samples 100
Epoch 0 Update 430 Cost 44.6723815126 Time 131.746731997 Samples 100
Epoch 0 Update 435 Cost 47.7370058953 Time 133.310719967 Samples 100
Epoch 0 Update 440 Cost 48.6830546081 Time 135.197814941 Samples 100
Epoch 0 Update 445 Cost 38.3501235392 Time 136.867908001 Samples 100
Epoch 0 Update 450 Cost 46.1262741696 Time 138.772145987 Samples 100
Epoch 0 Update 455 Cost 44.0773667646 Time 140.763146877 Samples 100
Epoch 0 Update 460 Cost 50.2007800696 Time 142.552611828 Samples 100
Epoch 0 Update 465 Cost 31.4776947429 Time 144.194105864 Samples 100
Epoch 0 Update 470 Cost 36.3560049357 Time 146.139782906 Samples 100
Epoch 0 Update 475 Cost 50.1845946701 Time 148.005964994 Samples 100
Epoch 0 Update 480 Cost 49.8087327118 Time 149.640110016 Samples 100
Epoch 0 Update 485 Cost 33.1349643833 Time 151.498419046 Samples 100
Epoch 0 Update 490 Cost 39.3266778818 Time 153.273735046 Samples 100
Epoch 0 Update 495 Cost 38.4444501186 Time 154.864804983 Samples 100
Epoch 0 Update 500 Cost 34.9551406723 Time 156.725205898 Samples 100
Epoch 0 Update 505 Cost 39.0778170378 Time 158.283269882 Samples 100
Epoch 0 Update 510 Cost 33.0351966424 Time 160.130072832 Samples 100
Epoch 0 Update 515 Cost 45.2413150209 Time 161.912999868 Samples 100
Epoch 0 Update 520 Cost 52.175408506 Time 163.622829914 Samples 100
Epoch 0 Update 525 Cost 56.6200187271 Time 165.512990952 Samples 100
Epoch 0 Update 530 Cost 43.7744947975 Time 167.197646856 Samples 100
Epoch 0 Update 535 Cost 38.080123542 Time 168.797770977 Samples 100
Epoch 0 Update 540 Cost 39.301743931 Time 170.199584007 Samples 100
Epoch 0 Update 545 Cost 40.6357206398 Time 172.00314784 Samples 100
Epoch 0 Update 550 Cost 43.1563982852 Time 174.020025969 Samples 100
Epoch 0 Update 555 Cost 37.6002915627 Time 175.76908803 Samples 100
Epoch 0 Update 560 Cost 41.0372347727 Time 177.493161917 Samples 100
Epoch 0 Update 565 Cost 34.0644046913 Time 179.316948891 Samples 100
Epoch 0 Update 570 Cost 43.8222641886 Time 181.373538017 Samples 100
Epoch 0 Update 575 Cost 40.8910175001 Time 183.312610865 Samples 100
Epoch 0 Update 580 Cost 42.5210873323 Time 184.973217964 Samples 100
Epoch 0 Update 585 Cost 43.7786655814 Time 186.509861946 Samples 100
Epoch 0 Update 590 Cost 47.7036779341 Time 188.479573011 Samples 100
Epoch 0 Update 595 Cost 45.9500657049 Time 190.278801918 Samples 100
Epoch 0 Update 600 Cost 34.8490899012 Time 191.918164968 Samples 100
Epoch 0 Update 605 Cost 33.4132369374 Time 193.771282911 Samples 100
Epoch 0 Update 610 Cost 39.2704960977 Time 195.542122841 Samples 100
Epoch 0 Update 615 Cost 29.9725587676 Time 197.278717995 Samples 100
Epoch 0 Update 620 Cost 47.2867539927 Time 199.177005053 Samples 100
Epoch 0 Update 625 Cost 37.9984703185 Time 201.370798826 Samples 100
Epoch 0 Update 630 Cost 44.0988610698 Time 203.630995989 Samples 100
Epoch 0 Update 635 Cost 39.2101849626 Time 205.953558922 Samples 100
Epoch 0 Update 640 Cost 48.1242224067 Time 207.78252387 Samples 100
Epoch 0 Update 645 Cost 41.0033273419 Time 209.482738018 Samples 100
Epoch 0 Update 650 Cost 42.6447264724 Time 211.420992851 Samples 100
Epoch 0 Update 655 Cost 43.7019853492 Time 213.178817987 Samples 100
Epoch 0 Update 660 Cost 35.8664013005 Time 215.331609964 Samples 100
Epoch 0 Update 665 Cost 40.7309824488 Time 217.370992899 Samples 100
Epoch 0 Update 670 Cost 34.800015388 Time 219.522330999 Samples 100
Epoch 0 Update 675 Cost 29.5000503744 Time 221.554313898 Samples 100
Epoch 0 Update 680 Cost 44.344702313 Time 223.333487034 Samples 100
Epoch 0 Update 685 Cost 39.3778841661 Time 225.089062929 Samples 100
Epoch 0 Update 690 Cost 37.2839231114 Time 227.092090845 Samples 100
Epoch 0 Update 695 Cost 38.4006606094 Time 229.022737026 Samples 100
Epoch 0 Update 700 Cost 39.6420742226 Time 230.68688488 Samples 100
Epoch 0 Update 705 Cost 34.482394858 Time 232.526938915 Samples 100
Epoch 0 Update 710 Cost 40.1527251387 Time 234.416556835 Samples 100
Epoch 0 Update 715 Cost 30.5771422985 Time 236.256736994 Samples 100
Epoch 0 Update 720 Cost 42.9385877911 Time 238.232885838 Samples 100
Epoch 0 Update 725 Cost 45.7934754468 Time 240.101362944 Samples 100
Epoch 0 Update 730 Cost 40.1671728072 Time 242.377202988 Samples 100
Epoch 0 Update 735 Cost 33.2723065707 Time 244.090628862 Samples 100
Epoch 0 Update 740 Cost 30.4448798907 Time 245.991605997 Samples 100
Epoch 0 Update 745 Cost 43.407410122 Time 247.980182886 Samples 100
Epoch 0 Update 750 Cost 32.7788121317 Time 249.765976906 Samples 100
Epoch 0 Update 755 Cost 38.3065246966 Time 251.705076933 Samples 100
Epoch 0 Update 760 Cost 31.2751738562 Time 253.506507874 Samples 100
Epoch 0 Update 765 Cost 36.564677213 Time 255.406138897 Samples 100
Epoch 0 Update 770 Cost 37.0253966761 Time 257.1148839 Samples 100
Epoch 0 Update 775 Cost 39.7428311031 Time 259.094158888 Samples 100
Epoch 0 Update 780 Cost 47.9184386353 Time 261.035534859 Samples 100
Epoch 0 Update 785 Cost 36.8743280685 Time 263.005434036 Samples 100
Epoch 0 Update 790 Cost 38.0148189856 Time 264.740644932 Samples 100
Epoch 0 Update 795 Cost 46.0314698657 Time 266.410226822 Samples 100
Epoch 0 Update 800 Cost 50.9512241391 Time 268.335808039 Samples 100
Epoch 0 Update 805 Cost 35.9736374515 Time 269.99596405 Samples 100
Epoch 0 Update 810 Cost 35.5938985665 Time 271.682427883 Samples 100
Epoch 0 Update 815 Cost 41.3264215901 Time 273.50553894 Samples 100
Epoch 0 Update 820 Cost 36.0439130325 Time 275.269672871 Samples 100
Epoch 0 Update 825 Cost 38.9021341697 Time 277.348407984 Samples 100
Epoch 0 Update 830 Cost 36.6433806369 Time 279.069483995 Samples 100
Epoch 0 Update 835 Cost 28.8963835097 Time 281.095913887 Samples 100
Epoch 0 Update 840 Cost 41.0809028651 Time 282.731619835 Samples 100
Epoch 0 Update 845 Cost 46.9671363098 Time 284.181861877 Samples 100
Epoch 0 Update 850 Cost 31.2516987849 Time 286.096856833 Samples 100
Epoch 0 Update 855 Cost 42.4452349471 Time 288.012486935 Samples 100
Epoch 0 Update 860 Cost 33.8300809267 Time 289.989826918 Samples 100
Epoch 0 Update 865 Cost 33.277558496 Time 291.843116999 Samples 100
Epoch 0 Update 870 Cost 32.4969330246 Time 293.560262918 Samples 100
Epoch 0 Update 875 Cost 37.2035738044 Time 295.557832956 Samples 100
Epoch 0 Update 880 Cost 28.1477003377 Time 297.354331017 Samples 100
Epoch 0 Update 885 Cost 32.7800070502 Time 299.072005987 Samples 100
Epoch 0 Update 890 Cost 32.0747930785 Time 300.706902027 Samples 100
Epoch 0 Update 895 Cost 44.5664883709 Time 302.287466049 Samples 100
Epoch 0 Update 900 Cost 33.1984264322 Time 303.847563982 Samples 100
Epoch 0 Update 905 Cost 38.0210367472 Time 305.565690994 Samples 100
Epoch 0 Update 910 Cost 37.1892226556 Time 307.331687927 Samples 100
Epoch 0 Update 915 Cost 38.0854844428 Time 309.344820976 Samples 100
Epoch 0 Update 920 Cost 28.8392036256 Time 311.002410889 Samples 100
Epoch 0 Update 925 Cost 38.0236361489 Time 313.113240957 Samples 100
Epoch 0 Update 930 Cost 31.2419160721 Time 314.657341957 Samples 100
Epoch 0 Update 935 Cost 35.8579508784 Time 316.73831892 Samples 100
Epoch 0 Update 940 Cost 28.6518624575 Time 318.707263947 Samples 100
Epoch 0 Update 945 Cost 36.4271646798 Time 320.99029994 Samples 100
Epoch 0 Update 950 Cost 31.5131125558 Time 322.753849983 Samples 100
Epoch 0 Update 955 Cost 33.7740665562 Time 324.27203989 Samples 100
Epoch 0 Update 960 Cost 34.9644332238 Time 325.655887842 Samples 100
Epoch 0 Update 965 Cost 39.5495993552 Time 327.271900892 Samples 100
Epoch 0 Update 970 Cost 37.2547714202 Time 329.12192893 Samples 100
Epoch 0 Update 975 Cost 27.6678509231 Time 330.604148865 Samples 100
Epoch 0 Update 980 Cost 32.3264388502 Time 332.294898987 Samples 100
Epoch 0 Update 985 Cost 32.2766407482 Time 334.05428791 Samples 100
Epoch 0 Update 990 Cost 41.2621937295 Time 335.853971004 Samples 100
Epoch 0 Update 995 Cost 33.8892952797 Time 337.337370872 Samples 100
Epoch 0 Update 1000 Cost 42.4728655958 Time 338.949364901 Samples 100
Saving...
Testing on Validation set...
####### NEW BEST VALID #######
Epoch 0 Update 1000 Training Cost 45.6001668919 Validation mean rank 24267.3939738 Validation hit@10 25.6423970939% Validation hit@1 4.02709990863%
                                               Testing mean rank 24445.7371659 Testing hit@10 25.4344182764% Testing hit@1 3.82376290024%
Epoch 0 Update 1005 Cost 49.1151770325 Time 39146.8339379 Samples 100
Epoch 0 Update 1010 Cost 37.4797939974 Time 39148.7030768 Samples 100
Epoch 0 Update 1015 Cost 34.1831408901 Time 39151.3715789 Samples 100
Epoch 0 Update 1020 Cost 32.8936796855 Time 39153.585587 Samples 100
Epoch 0 Update 1025 Cost 25.8774094835 Time 39155.333657 Samples 100
Epoch 0 Update 1030 Cost 30.5969469918 Time 39157.0576658 Samples 100
Epoch 0 Update 1035 Cost 33.9427584803 Time 39158.7491479 Samples 100
Epoch 0 Update 1040 Cost 38.2187489367 Time 39160.795814 Samples 100
Epoch 0 Update 1045 Cost 35.3424993743 Time 39162.6281009 Samples 100
Epoch 0 Update 1050 Cost 36.79538204 Time 39165.1289608 Samples 100
Epoch 0 Update 1055 Cost 31.374378272 Time 39167.025954 Samples 100
Epoch 0 Update 1060 Cost 40.161169978 Time 39168.8004889 Samples 100
Epoch 0 Update 1065 Cost 36.8418244542 Time 39170.478966 Samples 100
Epoch 0 Update 1070 Cost 24.0821928661 Time 39172.2769489 Samples 100
Epoch 0 Update 1075 Cost 26.6923394143 Time 39174.318356 Samples 100
Epoch 0 Update 1080 Cost 35.7619974824 Time 39176.0806949 Samples 100
Epoch 0 Update 1085 Cost 35.0229370916 Time 39178.082119 Samples 100
Epoch 0 Update 1090 Cost 36.7469680213 Time 39179.919009 Samples 100
Epoch 0 Update 1095 Cost 37.4853318128 Time 39181.6737258 Samples 100
Epoch 0 Update 1100 Cost 34.1687407476 Time 39183.517956 Samples 100
Epoch 0 Update 1105 Cost 36.8154048327 Time 39185.2974589 Samples 100
Epoch 0 Update 1110 Cost 32.1010018659 Time 39187.3517098 Samples 100
Epoch 0 Update 1115 Cost 38.830559473 Time 39189.356626 Samples 100
Epoch 0 Update 1120 Cost 33.3010128132 Time 39191.7166779 Samples 100
Epoch 0 Update 1125 Cost 33.2846467817 Time 39193.51035 Samples 100
Epoch 0 Update 1130 Cost 25.5140797102 Time 39195.3888149 Samples 100
Epoch 0 Update 1135 Cost 35.9792212807 Time 39197.0460758 Samples 100
Epoch 0 Update 1140 Cost 26.1705289193 Time 39199.288013 Samples 100
Epoch 0 Update 1145 Cost 28.4731825127 Time 39201.121336 Samples 100
Epoch 0 Update 1150 Cost 27.3446357951 Time 39202.683085 Samples 100
Epoch 0 Update 1155 Cost 34.48314072 Time 39204.383857 Samples 100
Epoch 0 Update 1160 Cost 33.973681196 Time 39206.6197739 Samples 100
Epoch 0 Update 1165 Cost 36.7842319018 Time 39209.0683939 Samples 100
Epoch 0 Update 1170 Cost 33.6838474058 Time 39211.1598089 Samples 100
Epoch 0 Update 1175 Cost 26.6622342783 Time 39212.803766 Samples 100
Epoch 0 Update 1180 Cost 25.879902214 Time 39215.949666 Samples 100
Epoch 0 Update 1185 Cost 38.4965519645 Time 39218.6581299 Samples 100
Epoch 0 Update 1190 Cost 34.4592877611 Time 39220.901758 Samples 100
Epoch 0 Update 1195 Cost 26.5968700192 Time 39223.8239129 Samples 100
Epoch 0 Update 1200 Cost 33.7299689897 Time 39225.8804801 Samples 100
Epoch 0 Update 1205 Cost 27.4230938709 Time 39227.9225459 Samples 100
Epoch 0 Update 1210 Cost 36.8706740637 Time 39229.639693 Samples 100
Epoch 0 Update 1215 Cost 31.4446592137 Time 39231.717818 Samples 100
Epoch 0 Update 1220 Cost 34.0418456319 Time 39233.5973299 Samples 100
Epoch 0 Update 1225 Cost 32.6902271498 Time 39236.1104579 Samples 100
Epoch 0 Update 1230 Cost 31.8044301607 Time 39238.2138739 Samples 100
Epoch 0 Update 1235 Cost 25.2454893358 Time 39240.156172 Samples 100
Epoch 0 Update 1240 Cost 36.6012889107 Time 39242.8046839 Samples 100
Epoch 0 Update 1245 Cost 36.2541688107 Time 39244.952472 Samples 100
Epoch 0 Update 1250 Cost 29.3121391398 Time 39247.443527 Samples 100
Epoch 0 Update 1255 Cost 30.6630267547 Time 39249.718869 Samples 100
Epoch 0 Update 1260 Cost 38.0118043225 Time 39251.9432008 Samples 100
Epoch 0 Update 1265 Cost 39.759828208 Time 39253.8719399 Samples 100
Epoch 0 Update 1270 Cost 31.0242888827 Time 39256.0556839 Samples 100
Epoch 0 Update 1275 Cost 33.6759340249 Time 39258.2765219 Samples 100
Epoch 0 Update 1280 Cost 24.1989002277 Time 39260.1483059 Samples 100
Epoch 0 Update 1285 Cost 24.5735087202 Time 39261.7348719 Samples 100
Epoch 0 Update 1290 Cost 33.6759703057 Time 39263.8199749 Samples 100
Epoch 0 Update 1295 Cost 28.3936415145 Time 39266.496578 Samples 100
Epoch 0 Update 1300 Cost 27.7515238875 Time 39268.5980279 Samples 100
Epoch 0 Update 1305 Cost 28.9117027518 Time 39270.7294099 Samples 100
Epoch 0 Update 1310 Cost 30.0727643283 Time 39273.1138048 Samples 100
Epoch 0 Update 1315 Cost 33.6574360647 Time 39274.9173188 Samples 100
Epoch 0 Update 1320 Cost 32.8205173333 Time 39277.160655 Samples 100
Epoch 0 Update 1325 Cost 31.122226736 Time 39279.23667 Samples 100
Epoch 0 Update 1330 Cost 32.9566408585 Time 39281.528455 Samples 100
Epoch 0 Update 1335 Cost 34.375413824 Time 39283.7610669 Samples 100
Epoch 0 Update 1340 Cost 29.6693418697 Time 39286.040714 Samples 100
Epoch 0 Update 1345 Cost 27.779740015 Time 39288.4464519 Samples 100
Epoch 0 Update 1350 Cost 35.5573162796 Time 39290.5892639 Samples 100
Epoch 0 Update 1355 Cost 32.423576845 Time 39292.702544 Samples 100
Epoch 0 Update 1360 Cost 32.3324844008 Time 39294.799475 Samples 100
Epoch 0 Update 1365 Cost 32.4859269736 Time 39296.8138258 Samples 100
Epoch 0 Update 1370 Cost 35.9815742715 Time 39298.9653111 Samples 100
Epoch 0 Update 1375 Cost 34.8091048526 Time 39300.8826509 Samples 100
Epoch 0 Update 1380 Cost 32.5098956267 Time 39302.6436329 Samples 100
Epoch 0 Update 1385 Cost 39.7707975835 Time 39304.797122 Samples 100
Epoch 0 Update 1390 Cost 37.378264162 Time 39306.6076419 Samples 100
Epoch 0 Update 1395 Cost 40.866993758 Time 39308.5413508 Samples 100
Epoch 0 Update 1400 Cost 34.2524726683 Time 39310.50402 Samples 100
Epoch 0 Update 1405 Cost 31.5794667488 Time 39312.676172 Samples 100
Epoch 0 Update 1410 Cost 27.4172883627 Time 39314.6701238 Samples 100
Epoch 0 Update 1415 Cost 30.0011165132 Time 39316.6349509 Samples 100
Epoch 0 Update 1420 Cost 29.3940251278 Time 39318.80516 Samples 100
Epoch 0 Update 1425 Cost 39.0772130981 Time 39320.8399389 Samples 100
Epoch 0 Update 1430 Cost 31.4091144101 Time 39322.67799 Samples 100
Epoch 0 Update 1435 Cost 30.8752335734 Time 39324.8193998 Samples 100
Epoch 0 Update 1440 Cost 33.2446186521 Time 39326.8158269 Samples 100
Epoch 0 Update 1445 Cost 32.5522998078 Time 39329.2063849 Samples 100
Epoch 0 Update 1450 Cost 40.342439628 Time 39331.5045888 Samples 100
Epoch 0 Update 1455 Cost 36.083672382 Time 39333.2805769 Samples 100
Epoch 0 Update 1460 Cost 27.2519790222 Time 39335.388706 Samples 100
Epoch 0 Update 1465 Cost 26.9919075817 Time 39337.685508 Samples 100
Epoch 0 Update 1470 Cost 36.9689150889 Time 39340.049804 Samples 100
Epoch 0 Update 1475 Cost 33.4925132692 Time 39342.4275379 Samples 100
Epoch 0 Update 1480 Cost 26.9660802426 Time 39344.9074678 Samples 100
Epoch 0 Update 1485 Cost 32.6751129654 Time 39346.879425 Samples 100
Epoch 0 Update 1490 Cost 42.2963509923 Time 39348.875834 Samples 100
Epoch 0 Update 1495 Cost 29.6558598723 Time 39351.1405599 Samples 100
Epoch 0 Update 1500 Cost 28.9173951211 Time 39353.5645518 Samples 100
Epoch 0 Update 1505 Cost 31.3815192988 Time 39355.8572779 Samples 100
Epoch 0 Update 1510 Cost 25.6753741885 Time 39358.212925 Samples 100
Epoch 0 Update 1515 Cost 30.9142509878 Time 39360.154809 Samples 100
Epoch 0 Update 1520 Cost 28.4127977245 Time 39362.215852 Samples 100
Epoch 0 Update 1525 Cost 36.0767841123 Time 39364.14363 Samples 100
Epoch 0 Update 1530 Cost 43.0150044173 Time 39366.1780319 Samples 100
Epoch 0 Update 1535 Cost 27.7079731883 Time 39367.93209 Samples 100
Epoch 0 Update 1540 Cost 25.288900607 Time 39370.1002169 Samples 100
Epoch 0 Update 1545 Cost 35.4620034296 Time 39372.2262359 Samples 100
Epoch 0 Update 1550 Cost 28.4453847284 Time 39374.1221769 Samples 100
Epoch 0 Update 1555 Cost 36.2959105389 Time 39376.0165229 Samples 100
Epoch 0 Update 1560 Cost 33.3277051015 Time 39378.8535049 Samples 100
Epoch 0 Update 1565 Cost 36.9324944468 Time 39381.1944919 Samples 100
Epoch 0 Update 1570 Cost 32.1525588443 Time 39383.0937378 Samples 100
Epoch 0 Update 1575 Cost 32.9622687676 Time 39384.8858559 Samples 100
Epoch 0 Update 1580 Cost 29.3165532561 Time 39386.615628 Samples 100
Epoch 0 Update 1585 Cost 33.9834179646 Time 39388.6880388 Samples 100
Epoch 0 Update 1590 Cost 22.5145288072 Time 39391.0102229 Samples 100
Epoch 0 Update 1595 Cost 36.9783126673 Time 39393.249639 Samples 100
Epoch 0 Update 1600 Cost 30.1007738471 Time 39395.1767418 Samples 100
Epoch 0 Update 1605 Cost 30.9205410476 Time 39397.1565039 Samples 100
Epoch 0 Update 1610 Cost 28.5476898978 Time 39398.9133019 Samples 100
Epoch 0 Update 1615 Cost 37.2027700657 Time 39400.636766 Samples 100
Epoch 0 Update 1620 Cost 41.5536267741 Time 39402.3022518 Samples 100
Epoch 0 Update 1625 Cost 30.5051835048 Time 39404.3366129 Samples 100
Epoch 0 Update 1630 Cost 40.686783596 Time 39406.3103988 Samples 100
Epoch 0 Update 1635 Cost 24.9254613067 Time 39408.202647 Samples 100
Epoch 0 Update 1640 Cost 36.6994936165 Time 39410.174114 Samples 100
Epoch 0 Update 1645 Cost 39.0587710926 Time 39412.0436859 Samples 100
Epoch 0 Update 1650 Cost 33.763554602 Time 39414.030926 Samples 100
Epoch 0 Update 1655 Cost 38.9791068105 Time 39415.8588049 Samples 100
Epoch 0 Update 1660 Cost 25.7640322709 Time 39417.74856 Samples 100
Epoch 0 Update 1665 Cost 30.2393079381 Time 39419.9397938 Samples 100
Epoch 0 Update 1670 Cost 39.5331523533 Time 39421.9219 Samples 100
Epoch 0 Update 1675 Cost 24.9137070219 Time 39423.9017968 Samples 100
Epoch 0 Update 1680 Cost 29.9119110379 Time 39426.143049 Samples 100
Epoch 0 Update 1685 Cost 36.985965835 Time 39428.399883 Samples 100
Epoch 0 Update 1690 Cost 27.6043696259 Time 39430.2537239 Samples 100
Epoch 0 Update 1695 Cost 26.9046790642 Time 39432.149771 Samples 100
Epoch 0 Update 1700 Cost 30.0368868486 Time 39434.6492839 Samples 100
Epoch 0 Update 1705 Cost 34.0014715833 Time 39436.585994 Samples 100
Epoch 0 Update 1710 Cost 33.0993895306 Time 39438.9346149 Samples 100
Epoch 0 Update 1715 Cost 26.4969784746 Time 39440.692652 Samples 100
Epoch 0 Update 1720 Cost 29.8301137738 Time 39442.4953809 Samples 100
Epoch 0 Update 1725 Cost 25.3890983875 Time 39444.7221019 Samples 100
Epoch 0 Update 1730 Cost 27.1737441695 Time 39446.5874369 Samples 100
Epoch 0 Update 1735 Cost 36.1177080136 Time 39448.397289 Samples 100
Epoch 0 Update 1740 Cost 22.3811780897 Time 39450.137598 Samples 100
Epoch 0 Update 1745 Cost 31.1202072763 Time 39451.9791958 Samples 100
Epoch 0 Update 1750 Cost 26.5009178501 Time 39453.6447721 Samples 100
Epoch 0 Update 1755 Cost 34.2701339571 Time 39455.281765 Samples 100
Epoch 0 Update 1760 Cost 34.352993726 Time 39457.325742 Samples 100
Epoch 0 Update 1765 Cost 23.5921935678 Time 39458.902776 Samples 100
Epoch 0 Update 1770 Cost 32.3842661559 Time 39460.9330108 Samples 100
Epoch 0 Update 1775 Cost 29.9514062541 Time 39462.6115909 Samples 100
Epoch 0 Update 1780 Cost 36.1854625358 Time 39464.4982469 Samples 100
Epoch 0 Update 1785 Cost 27.7135345961 Time 39466.6471539 Samples 100
Epoch 0 Update 1790 Cost 23.8632163611 Time 39468.2023199 Samples 100
Epoch 0 Update 1795 Cost 24.1352144095 Time 39469.9771359 Samples 100
Epoch 0 Update 1800 Cost 23.6249680992 Time 39471.7730489 Samples 100
Epoch 0 Update 1805 Cost 23.4440297882 Time 39473.644031 Samples 100
Epoch 0 Update 1810 Cost 31.2132871803 Time 39476.1227179 Samples 100
Epoch 0 Update 1815 Cost 42.553423962 Time 39477.991941 Samples 100
Epoch 0 Update 1820 Cost 27.1546125729 Time 39480.2092359 Samples 100
Epoch 0 Update 1825 Cost 36.3716298651 Time 39482.2078569 Samples 100
Epoch 0 Update 1830 Cost 33.6418908824 Time 39484.3789239 Samples 100
Epoch 0 Update 1835 Cost 32.2892117247 Time 39486.407979 Samples 100
Epoch 0 Update 1840 Cost 27.8080505862 Time 39488.8772099 Samples 100
Epoch 0 Update 1845 Cost 43.0005655574 Time 39490.7146459 Samples 100
Epoch 0 Update 1850 Cost 41.7564107499 Time 39492.7746398 Samples 100
Epoch 0 Update 1855 Cost 28.8238806471 Time 39494.915606 Samples 100
Epoch 0 Update 1860 Cost 26.8557416324 Time 39497.0133898 Samples 100
Epoch 0 Update 1865 Cost 26.9032724026 Time 39498.8613288 Samples 100
Epoch 0 Update 1870 Cost 29.0079676152 Time 39500.663312 Samples 100
Epoch 0 Update 1875 Cost 30.9023215585 Time 39502.878792 Samples 100
Epoch 0 Update 1880 Cost 29.241268051 Time 39504.4619479 Samples 100
Epoch 0 Update 1885 Cost 29.8834711288 Time 39506.7537799 Samples 100
Epoch 0 Update 1890 Cost 23.6170042089 Time 39508.8572788 Samples 100
Epoch 0 Update 1895 Cost 31.5741605343 Time 39511.1512768 Samples 100
Epoch 0 Update 1900 Cost 34.4367238984 Time 39512.833626 Samples 100
Epoch 0 Update 1905 Cost 34.1321021837 Time 39514.86043 Samples 100
Epoch 0 Update 1910 Cost 22.3070895323 Time 39516.5004909 Samples 100
Epoch 0 Update 1915 Cost 40.6025461904 Time 39518.0933399 Samples 100
Epoch 0 Update 1920 Cost 38.0374809231 Time 39520.030899 Samples 100
Epoch 0 Update 1925 Cost 31.2861389852 Time 39522.3654959 Samples 100
Epoch 0 Update 1930 Cost 40.677187098 Time 39524.3019009 Samples 100
Epoch 0 Update 1935 Cost 30.8762929007 Time 39526.2174668 Samples 100
Epoch 0 Update 1940 Cost 34.8742966195 Time 39528.7792149 Samples 100
Epoch 0 Update 1945 Cost 26.5539068803 Time 39530.718245 Samples 100
Epoch 0 Update 1950 Cost 23.8166270574 Time 39533.0731108 Samples 100
Epoch 0 Update 1955 Cost 20.6483642654 Time 39534.93154 Samples 100
Epoch 0 Update 1960 Cost 33.1257007814 Time 39536.840466 Samples 100
Epoch 0 Update 1965 Cost 25.5007291576 Time 39538.8468239 Samples 100
Epoch 0 Update 1970 Cost 34.3310072996 Time 39540.9403238 Samples 100
Epoch 0 Update 1975 Cost 27.6807496158 Time 39543.0591819 Samples 100
Epoch 0 Update 1980 Cost 30.6441666053 Time 39545.201992 Samples 100
Epoch 0 Update 1985 Cost 28.8145520549 Time 39547.4656188 Samples 100
Epoch 0 Update 1990 Cost 33.2800145698 Time 39549.415128 Samples 100
Epoch 0 Update 1995 Cost 34.598134226 Time 39551.5111139 Samples 100
Epoch 0 Update 2000 Cost 25.722228765 Time 39553.371897 Samples 100
Saving...
Testing on Validation set...
####### NEW BEST VALID #######
Epoch 0 Update 2000 Training Cost 38.8116247539 Validation mean rank 22161.3317064 Validation hit@10 25.8920015155% Validation hit@1 5.80998863408%
                                               Testing mean rank 22411.4218268 Testing hit@10 25.734321249% Testing hit@1 5.74887536385%
Epoch 0 Update 2005 Cost 24.2173596804 Time 77788.4610028 Samples 100
Epoch 0 Update 2010 Cost 22.1989158229 Time 77789.8734479 Samples 100
Epoch 0 Update 2015 Cost 24.5794278976 Time 77791.6550379 Samples 100
Epoch 0 Update 2020 Cost 26.9049352637 Time 77793.96558 Samples 100
Epoch 0 Update 2025 Cost 24.3733759093 Time 77795.834337 Samples 100
Epoch 0 Update 2030 Cost 23.6229425514 Time 77797.973274 Samples 100
Epoch 0 Update 2035 Cost 27.6669931875 Time 77799.665796 Samples 100
Epoch 0 Update 2040 Cost 25.7121135982 Time 77801.395612 Samples 100
Epoch 0 Update 2045 Cost 30.9134849824 Time 77803.556268 Samples 100
Epoch 0 Update 2050 Cost 31.3741168645 Time 77805.4565198 Samples 100
Epoch 0 Update 2055 Cost 38.1803020502 Time 77807.814714 Samples 100
Epoch 0 Update 2060 Cost 34.8631089743 Time 77809.697314 Samples 100
Epoch 0 Update 2065 Cost 29.3882375557 Time 77811.754987 Samples 100
Epoch 0 Update 2070 Cost 26.6026728551 Time 77813.295989 Samples 100
Epoch 0 Update 2075 Cost 27.2713779372 Time 77815.6305139 Samples 100
Epoch 0 Update 2080 Cost 22.5836442013 Time 77818.1149418 Samples 100
Epoch 0 Update 2085 Cost 30.6600088831 Time 77820.122699 Samples 100
Epoch 0 Update 2090 Cost 30.182796549 Time 77822.0225849 Samples 100
Epoch 0 Update 2095 Cost 20.0959628499 Time 77823.9775748 Samples 100
Epoch 0 Update 2100 Cost 32.4603117502 Time 77825.591085 Samples 100
Epoch 0 Update 2105 Cost 41.457592231 Time 77827.071521 Samples 100
Epoch 0 Update 2110 Cost 25.1028303623 Time 77829.3097529 Samples 100
Epoch 0 Update 2115 Cost 27.1696550477 Time 77831.427093 Samples 100
Epoch 0 Update 2120 Cost 38.7159811817 Time 77833.454639 Samples 100
Epoch 0 Update 2125 Cost 22.8505882227 Time 77835.736634 Samples 100
Epoch 0 Update 2130 Cost 24.5533739622 Time 77838.0362129 Samples 100
Epoch 0 Update 2135 Cost 29.3845208712 Time 77840.2513089 Samples 100
Epoch 0 Update 2140 Cost 28.0510514385 Time 77842.1276689 Samples 100
Epoch 0 Update 2145 Cost 30.9839534853 Time 77844.183363 Samples 100
Epoch 0 Update 2150 Cost 34.0852181281 Time 77846.4984179 Samples 100
Epoch 0 Update 2155 Cost 25.6244651553 Time 77848.5886199 Samples 100
Epoch 0 Update 2160 Cost 25.3734182073 Time 77850.14341 Samples 100
Epoch 0 Update 2165 Cost 34.1815488262 Time 77852.192095 Samples 100
Epoch 0 Update 2170 Cost 32.0390326819 Time 77854.2232399 Samples 100
Epoch 0 Update 2175 Cost 24.7849506636 Time 77855.6457689 Samples 100
Epoch 0 Update 2180 Cost 36.0586715988 Time 77857.653367 Samples 100
Epoch 0 Update 2185 Cost 26.9856480855 Time 77859.659755 Samples 100
Epoch 0 Update 2190 Cost 29.9818693512 Time 77862.073298 Samples 100
Epoch 0 Update 2195 Cost 32.5668559632 Time 77864.107116 Samples 100
Epoch 0 Update 2200 Cost 33.0429740163 Time 77865.8390729 Samples 100
Epoch 0 Update 2205 Cost 32.212503955 Time 77867.678793 Samples 100
Epoch 0 Update 2210 Cost 23.6245477558 Time 77869.9780629 Samples 100
Epoch 0 Update 2215 Cost 28.5067800074 Time 77872.1149909 Samples 100
Epoch 0 Update 2220 Cost 31.9727669229 Time 77874.2816989 Samples 100
Epoch 0 Update 2225 Cost 40.5533876492 Time 77876.076638 Samples 100
Epoch 0 Update 2230 Cost 23.22956345 Time 77878.1482649 Samples 100
Epoch 0 Update 2235 Cost 29.1824795571 Time 77880.070483 Samples 100
Epoch 0 Update 2240 Cost 24.551197307 Time 77881.9329159 Samples 100
Epoch 0 Update 2245 Cost 21.3540137947 Time 77883.69238 Samples 100
Epoch 0 Update 2250 Cost 27.1596073072 Time 77885.6556909 Samples 100
Epoch 0 Update 2255 Cost 33.2719528737 Time 77888.374346 Samples 100
Epoch 0 Update 2260 Cost 20.6626470368 Time 77890.2665699 Samples 100
Epoch 0 Update 2265 Cost 28.1152916785 Time 77892.3898499 Samples 100
Epoch 0 Update 2270 Cost 28.8700374896 Time 77894.7107689 Samples 100
Epoch 0 Update 2275 Cost 30.596600909 Time 77896.9894519 Samples 100
Epoch 0 Update 2280 Cost 27.2442510617 Time 77898.7239389 Samples 100
Epoch 0 Update 2285 Cost 29.2234280824 Time 77900.5010099 Samples 100
Epoch 0 Update 2290 Cost 25.7843038075 Time 77902.2333479 Samples 100
Epoch 0 Update 2295 Cost 24.7699561479 Time 77904.162051 Samples 100
Epoch 0 Update 2300 Cost 28.3004001286 Time 77905.9845629 Samples 100
Epoch 0 Update 2305 Cost 23.1952507761 Time 77908.2842069 Samples 100
Epoch 0 Update 2310 Cost 30.3610049897 Time 77909.961762 Samples 100
Epoch 0 Update 2315 Cost 42.9066698923 Time 77911.9870219 Samples 100
Epoch 0 Update 2320 Cost 23.5729755832 Time 77913.6888258 Samples 100
Epoch 0 Update 2325 Cost 38.8379442523 Time 77915.4712889 Samples 100
Epoch 0 Update 2330 Cost 31.2473406692 Time 77918.158833 Samples 100
Epoch 0 Update 2335 Cost 23.9834040836 Time 77920.43799 Samples 100
Epoch 0 Update 2340 Cost 20.6620844723 Time 77922.4796829 Samples 100
Epoch 0 Update 2345 Cost 23.6817606824 Time 77924.4888558 Samples 100
Epoch 0 Update 2350 Cost 27.201361129 Time 77926.1401939 Samples 100
Epoch 0 Update 2355 Cost 31.4362220337 Time 77928.16326 Samples 100
Epoch 0 Update 2360 Cost 28.9353561633 Time 77929.9325359 Samples 100
Epoch 0 Update 2365 Cost 21.7080581754 Time 77931.8338499 Samples 100
Epoch 0 Update 2370 Cost 20.605909244 Time 77934.3110549 Samples 100
Epoch 0 Update 2375 Cost 26.8311829037 Time 77936.1712759 Samples 100
Epoch 0 Update 2380 Cost 27.6283294001 Time 77937.8152509 Samples 100
Epoch 0 Update 2385 Cost 18.4033703507 Time 77939.8439679 Samples 100
Epoch 0 Update 2390 Cost 24.5024958685 Time 77941.9846349 Samples 100
Epoch 0 Update 2395 Cost 25.2412692448 Time 77943.917078 Samples 100
Epoch 0 Update 2400 Cost 28.5990803988 Time 77946.074775 Samples 100
Epoch 0 Update 2405 Cost 20.1294434937 Time 77948.0251069 Samples 100
Epoch 0 Update 2410 Cost 25.6035652529 Time 77949.785902 Samples 100
Epoch 0 Update 2415 Cost 25.3082471182 Time 77951.6701729 Samples 100
Epoch 0 Update 2420 Cost 28.4543681028 Time 77953.6459599 Samples 100
Epoch 0 Update 2425 Cost 28.4617116272 Time 77955.7102029 Samples 100
Epoch 0 Update 2430 Cost 22.9057300351 Time 77957.5515358 Samples 100
Epoch 0 Update 2435 Cost 34.1394086414 Time 77959.424222 Samples 100
Epoch 0 Update 2440 Cost 33.9575665493 Time 77961.8269908 Samples 100
Epoch 0 Update 2445 Cost 21.6467082865 Time 77963.9156909 Samples 100
Epoch 0 Update 2450 Cost 28.4898437701 Time 77965.748956 Samples 100
Epoch 0 Update 2455 Cost 39.2886824027 Time 77967.8013649 Samples 100
Epoch 0 Update 2460 Cost 20.263515115 Time 77970.0842109 Samples 100
Epoch 0 Update 2465 Cost 30.4755088577 Time 77972.728334 Samples 100
Epoch 0 Update 2470 Cost 23.3552789463 Time 77975.0725379 Samples 100
Epoch 0 Update 2475 Cost 29.3976060458 Time 77977.01405 Samples 100
Epoch 0 Update 2480 Cost 25.1238402126 Time 77978.767545 Samples 100
Epoch 0 Update 2485 Cost 24.325128375 Time 77981.312674 Samples 100
Epoch 0 Update 2490 Cost 27.854299877 Time 77983.2056398 Samples 100
Epoch 0 Update 2495 Cost 23.6308612469 Time 77985.7161179 Samples 100
Epoch 0 Update 2500 Cost 27.6478714193 Time 77987.939672 Samples 100
Epoch 0 Update 2505 Cost 20.4300151595 Time 77990.123853 Samples 100
Epoch 0 Update 2510 Cost 29.1325805555 Time 77992.0955169 Samples 100
Epoch 0 Update 2515 Cost 29.3053165441 Time 77993.992362 Samples 100
Epoch 0 Update 2520 Cost 29.0982778187 Time 77996.4870908 Samples 100
Epoch 0 Update 2525 Cost 26.2814535592 Time 77998.6990969 Samples 100
Epoch 0 Update 2530 Cost 25.1714643819 Time 78000.195734 Samples 100
Epoch 0 Update 2535 Cost 33.6985856916 Time 78001.9444408 Samples 100
Epoch 0 Update 2540 Cost 22.6483682194 Time 78004.2391338 Samples 100
Epoch 0 Update 2545 Cost 26.2426648191 Time 78006.182986 Samples 100
Epoch 0 Update 2550 Cost 30.2683637218 Time 78008.427505 Samples 100
Epoch 0 Update 2555 Cost 25.5464276078 Time 78010.2713339 Samples 100
Epoch 0 Update 2560 Cost 29.4122023302 Time 78012.5242989 Samples 100
Epoch 0 Update 2565 Cost 25.120673372 Time 78015.0945919 Samples 100
Epoch 0 Update 2570 Cost 28.3246196041 Time 78017.3941751 Samples 100
Epoch 0 Update 2575 Cost 31.9556477241 Time 78019.1115379 Samples 100
Epoch 0 Update 2580 Cost 33.7691484317 Time 78021.136292 Samples 100
Epoch 0 Update 2585 Cost 29.8855687182 Time 78023.4760699 Samples 100
Epoch 0 Update 2590 Cost 22.7534953873 Time 78025.829324 Samples 100
Epoch 0 Update 2595 Cost 39.7891284404 Time 78027.7981479 Samples 100
Epoch 0 Update 2600 Cost 28.9422206084 Time 78029.7715719 Samples 100
Epoch 0 Update 2605 Cost 30.4123152466 Time 78031.488431 Samples 100
Epoch 0 Update 2610 Cost 33.3695589193 Time 78033.6677499 Samples 100
Epoch 0 Update 2615 Cost 33.7951127636 Time 78035.7252491 Samples 100
Epoch 0 Update 2620 Cost 30.2372541441 Time 78038.023077 Samples 100
Epoch 0 Update 2625 Cost 31.98879538 Time 78040.028342 Samples 100
Epoch 0 Update 2630 Cost 26.6980802931 Time 78041.6004319 Samples 100
Epoch 0 Update 2635 Cost 34.1666488884 Time 78044.0571499 Samples 100
Epoch 0 Update 2640 Cost 27.42084628 Time 78046.3371959 Samples 100
Epoch 0 Update 2645 Cost 21.1255121238 Time 78048.3248038 Samples 100
Epoch 0 Update 2650 Cost 19.9614000796 Time 78050.2080269 Samples 100
Epoch 0 Update 2655 Cost 24.8521279926 Time 78052.552671 Samples 100
Epoch 0 Update 2660 Cost 20.5191325835 Time 78054.8782279 Samples 100
Epoch 0 Update 2665 Cost 30.4566813587 Time 78056.751235 Samples 100
Epoch 0 Update 2670 Cost 40.255349601 Time 78058.505842 Samples 100
Epoch 0 Update 2675 Cost 20.4288355777 Time 78060.3043571 Samples 100
Epoch 0 Update 2680 Cost 20.3621114461 Time 78062.5404859 Samples 100
Epoch 0 Update 2685 Cost 27.1521116631 Time 78065.3774049 Samples 100
Epoch 0 Update 2690 Cost 22.097309247 Time 78067.223732 Samples 100
Epoch 0 Update 2695 Cost 30.1413110602 Time 78069.2965989 Samples 100
Epoch 0 Update 2700 Cost 33.2591657637 Time 78071.1627228 Samples 100
Epoch 0 Update 2705 Cost 21.1096770837 Time 78073.2031798 Samples 100
Epoch 0 Update 2710 Cost 29.327997838 Time 78075.0359418 Samples 100
Epoch 0 Update 2715 Cost 24.7088980557 Time 78076.9132099 Samples 100
Epoch 0 Update 2720 Cost 39.4182779843 Time 78078.569556 Samples 100
Epoch 0 Update 2725 Cost 33.739750774 Time 78080.799541 Samples 100
Epoch 0 Update 2730 Cost 29.0529075056 Time 78082.680294 Samples 100
Epoch 0 Update 2735 Cost 31.8093509305 Time 78084.5420198 Samples 100
Epoch 0 Update 2740 Cost 32.7081485232 Time 78086.3203969 Samples 100
Epoch 0 Update 2745 Cost 35.9021385185 Time 78088.941139 Samples 100
Epoch 0 Update 2750 Cost 29.6417242213 Time 78090.7931819 Samples 100
Epoch 0 Update 2755 Cost 29.5360321651 Time 78092.7091169 Samples 100
Epoch 0 Update 2760 Cost 30.0639387319 Time 78094.638047 Samples 100
Epoch 0 Update 2765 Cost 34.5011904514 Time 78096.7833509 Samples 100
Epoch 0 Update 2770 Cost 26.2639456483 Time 78098.680459 Samples 100
Epoch 0 Update 2775 Cost 21.3753831996 Time 78100.571718 Samples 100
Epoch 0 Update 2780 Cost 24.4770453108 Time 78102.669523 Samples 100
Epoch 0 Update 2785 Cost 31.4173672557 Time 78104.386966 Samples 100
Epoch 0 Update 2790 Cost 30.3199815509 Time 78106.083564 Samples 100
Epoch 0 Update 2795 Cost 26.5561398898 Time 78108.066824 Samples 100
Epoch 0 Update 2800 Cost 33.6792023562 Time 78109.9187429 Samples 100
Epoch 0 Update 2805 Cost 24.9005400303 Time 78112.196661 Samples 100
Epoch 0 Update 2810 Cost 24.4682400728 Time 78114.1148169 Samples 100
Epoch 0 Update 2815 Cost 27.1777084114 Time 78115.9328718 Samples 100
Epoch 0 Update 2820 Cost 29.632965547 Time 78117.4826238 Samples 100
Epoch 0 Update 2825 Cost 28.3930004791 Time 78119.9291439 Samples 100
Epoch 0 Update 2830 Cost 30.1159545031 Time 78122.2422099 Samples 100
Epoch 0 Update 2835 Cost 24.0729397186 Time 78124.0788178 Samples 100
Epoch 0 Update 2840 Cost 29.6470463063 Time 78126.4078009 Samples 100
Epoch 0 Update 2845 Cost 33.353454731 Time 78128.3785009 Samples 100
Epoch 0 Update 2850 Cost 29.5291276834 Time 78130.7526588 Samples 100
Epoch 0 Update 2855 Cost 36.1194922556 Time 78132.5547609 Samples 100
Epoch 0 Update 2860 Cost 27.3193064409 Time 78134.352941 Samples 100
Epoch 0 Update 2865 Cost 35.2700419157 Time 78136.4498119 Samples 100
Epoch 0 Update 2870 Cost 28.7858176057 Time 78138.2366989 Samples 100
Epoch 0 Update 2875 Cost 25.815903377 Time 78140.229773 Samples 100
Epoch 0 Update 2880 Cost 32.5046865358 Time 78142.1167898 Samples 100
Epoch 0 Update 2885 Cost 29.3266436259 Time 78143.766099 Samples 100
Epoch 0 Update 2890 Cost 22.1260653637 Time 78145.313585 Samples 100
Epoch 0 Update 2895 Cost 29.0024040327 Time 78147.1048849 Samples 100
Epoch 0 Update 2900 Cost 25.7556853518 Time 78149.17869 Samples 100
Epoch 0 Update 2905 Cost 23.6792905588 Time 78151.089072 Samples 100
Epoch 0 Update 2910 Cost 28.7730086016 Time 78153.1698 Samples 100
Epoch 0 Update 2915 Cost 25.5942682874 Time 78154.7524109 Samples 100
Epoch 0 Update 2920 Cost 32.5055134833 Time 78157.062984 Samples 100
Epoch 0 Update 2925 Cost 29.9557766761 Time 78159.1311898 Samples 100
Epoch 0 Update 2930 Cost 30.1100114475 Time 78160.8606989 Samples 100
Epoch 0 Update 2935 Cost 22.115627879 Time 78162.897094 Samples 100
Epoch 0 Update 2940 Cost 27.8252547563 Time 78164.946955 Samples 100
Epoch 0 Update 2945 Cost 35.8535437931 Time 78166.9663 Samples 100
Epoch 0 Update 2950 Cost 32.1461302021 Time 78168.8613648 Samples 100
Epoch 0 Update 2955 Cost 32.3630871642 Time 78171.288507 Samples 100
Epoch 0 Update 2960 Cost 23.9198410157 Time 78173.1998339 Samples 100
Epoch 0 Update 2965 Cost 23.7685265727 Time 78174.9502909 Samples 100
Epoch 0 Update 2970 Cost 22.7352773823 Time 78176.975862 Samples 100
Epoch 0 Update 2975 Cost 36.8168182688 Time 78179.469909 Samples 100
Epoch 0 Update 2980 Cost 29.5849065313 Time 78181.682343 Samples 100
Epoch 0 Update 2985 Cost 20.7061546213 Time 78183.4310679 Samples 100
Epoch 0 Update 2990 Cost 33.2859868352 Time 78185.6367929 Samples 100
Epoch 0 Update 2995 Cost 19.8393965681 Time 78187.4782109 Samples 100
Epoch 0 Update 3000 Cost 29.9000336183 Time 78189.8044369 Samples 100
Saving...
Testing on Validation set...
####### NEW BEST VALID #######
Epoch 0 Update 3000 Training Cost 35.3658768161 Validation mean rank 21264.4330191 Validation hit@10 26.429096744% Validation hit@1 19.061309086%
                                               Testing mean rank 21468.6681662 Testing hit@10 26.2304842551% Testing hit@1 18.8299373732%
Epoch 0 Update 3005 Cost 22.8271739943 Time 114872.888495 Samples 100
Epoch 0 Update 3010 Cost 31.3202826181 Time 114874.99322 Samples 100
Epoch 0 Update 3015 Cost 20.6838809237 Time 114876.725084 Samples 100
Epoch 0 Update 3020 Cost 17.9471465283 Time 114878.773902 Samples 100
Epoch 0 Update 3025 Cost 30.1335730402 Time 114880.858219 Samples 100
Epoch 0 Update 3030 Cost 33.5405487659 Time 114882.792513 Samples 100
Epoch 0 Update 3035 Cost 26.5996163753 Time 114884.819149 Samples 100
Epoch 0 Update 3040 Cost 30.5483407869 Time 114886.85182 Samples 100
Epoch 0 Update 3045 Cost 28.7488712147 Time 114888.763986 Samples 100
Epoch 0 Update 3050 Cost 37.8895432042 Time 114890.558085 Samples 100
Epoch 0 Update 3055 Cost 22.6656673141 Time 114892.348284 Samples 100
Epoch 0 Update 3060 Cost 29.9348058322 Time 114894.190223 Samples 100
Epoch 0 Update 3065 Cost 30.0644399666 Time 114895.936796 Samples 100
Epoch 0 Update 3070 Cost 33.8454173218 Time 114898.057702 Samples 100
Epoch 0 Update 3075 Cost 32.68247247 Time 114899.772622 Samples 100
Epoch 0 Update 3080 Cost 22.0660506969 Time 114901.503314 Samples 100
Epoch 0 Update 3085 Cost 32.0227951135 Time 114903.363916 Samples 100
Epoch 0 Update 3090 Cost 30.8545027034 Time 114905.115494 Samples 100
Epoch 0 Update 3095 Cost 32.1938575267 Time 114906.976024 Samples 100
Epoch 0 Update 3100 Cost 29.6476926116 Time 114908.677532 Samples 100
Epoch 0 Update 3105 Cost 21.8359151397 Time 114910.492224 Samples 100
Epoch 0 Update 3110 Cost 30.9846953468 Time 114912.301907 Samples 100
Epoch 0 Update 3115 Cost 28.1404216609 Time 114914.172808 Samples 100
Epoch 0 Update 3120 Cost 26.6240821963 Time 114915.910888 Samples 100
Epoch 0 Update 3125 Cost 31.0173096573 Time 114917.798743 Samples 100
Epoch 0 Update 3130 Cost 23.7627898092 Time 114919.964744 Samples 100
Epoch 0 Update 3135 Cost 26.5427396799 Time 114922.114915 Samples 100
Epoch 0 Update 3140 Cost 31.5428258464 Time 114924.427274 Samples 100
Epoch 0 Update 3145 Cost 38.0512254271 Time 114926.161837 Samples 100
Epoch 0 Update 3150 Cost 25.7478835203 Time 114927.860308 Samples 100
Epoch 0 Update 3155 Cost 27.3062186985 Time 114929.586907 Samples 100
Epoch 0 Update 3160 Cost 22.8150401629 Time 114931.429034 Samples 100
Epoch 0 Update 3165 Cost 32.2434156311 Time 114933.268916 Samples 100
Epoch 0 Update 3170 Cost 31.1586094335 Time 114934.923462 Samples 100
Epoch 0 Update 3175 Cost 30.6483287287 Time 114937.02836 Samples 100
Epoch 0 Update 3180 Cost 35.3052536275 Time 114938.491499 Samples 100
Epoch 0 Update 3185 Cost 32.8268579813 Time 114940.155438 Samples 100
Epoch 0 Update 3190 Cost 37.8036804425 Time 114942.547758 Samples 100
Epoch 0 Update 3195 Cost 32.1512187328 Time 114944.63462 Samples 100
Epoch 0 Update 3200 Cost 28.0912247397 Time 114947.082906 Samples 100
Epoch 0 Update 3205 Cost 26.3129327775 Time 114949.628934 Samples 100
Epoch 0 Update 3210 Cost 30.3194675862 Time 114951.91899 Samples 100
Epoch 0 Update 3215 Cost 21.6004730942 Time 114953.629161 Samples 100
Epoch 0 Update 3220 Cost 24.7462828247 Time 114955.999505 Samples 100
Epoch 0 Update 3225 Cost 28.2456520412 Time 114958.189782 Samples 100
Epoch 0 Update 3230 Cost 28.7191147876 Time 114961.014345 Samples 100
Epoch 0 Update 3235 Cost 25.0987089742 Time 114963.254889 Samples 100
Epoch 0 Update 3240 Cost 25.003646096 Time 114965.313065 Samples 100
Epoch 0 Update 3245 Cost 29.6263152599 Time 114967.819038 Samples 100
Epoch 0 Update 3250 Cost 30.4538033261 Time 114969.594455 Samples 100
Epoch 0 Update 3255 Cost 18.1172515359 Time 114971.219841 Samples 100
Epoch 0 Update 3260 Cost 25.9328670947 Time 114972.986647 Samples 100
Epoch 0 Update 3265 Cost 29.8146001501 Time 114974.709298 Samples 100
Epoch 0 Update 3270 Cost 24.1769981746 Time 114976.668303 Samples 100
Epoch 0 Update 3275 Cost 26.5492159342 Time 114978.391192 Samples 100
Epoch 0 Update 3280 Cost 24.9085090609 Time 114980.225561 Samples 100
Epoch 0 Update 3285 Cost 34.4119481132 Time 114982.589062 Samples 100
Epoch 0 Update 3290 Cost 28.7257550898 Time 114984.915027 Samples 100
Epoch 0 Update 3295 Cost 32.7014799728 Time 114986.770839 Samples 100
Epoch 0 Update 3300 Cost 27.7148907108 Time 114988.690546 Samples 100
Epoch 0 Update 3305 Cost 31.1351152584 Time 114990.356088 Samples 100
Epoch 0 Update 3310 Cost 21.7633918246 Time 114992.23882 Samples 100
Epoch 0 Update 3315 Cost 29.4757481521 Time 114994.367366 Samples 100
Epoch 0 Update 3320 Cost 28.1159265742 Time 114996.728036 Samples 100
Epoch 0 Update 3325 Cost 29.1791915413 Time 114999.077626 Samples 100
Epoch 0 Update 3330 Cost 23.1070084265 Time 115001.572779 Samples 100
Epoch 0 Update 3335 Cost 26.5360998784 Time 115003.562275 Samples 100
Epoch 0 Update 3340 Cost 20.567438377 Time 115005.262612 Samples 100
Epoch 0 Update 3345 Cost 30.2492506054 Time 115007.130159 Samples 100
Epoch 0 Update 3350 Cost 18.1099819711 Time 115009.189345 Samples 100
Epoch 0 Update 3355 Cost 29.6746188585 Time 115011.163594 Samples 100
Epoch 0 Update 3360 Cost 30.7155070407 Time 115013.070029 Samples 100
Epoch 0 Update 3365 Cost 28.6776479978 Time 115015.125441 Samples 100
Epoch 0 Update 3370 Cost 23.6048282503 Time 115017.433704 Samples 100
Epoch 0 Update 3375 Cost 22.2377619391 Time 115019.502721 Samples 100
Epoch 0 Update 3380 Cost 27.5916115211 Time 115021.703722 Samples 100
Epoch 0 Update 3385 Cost 30.538266511 Time 115023.759894 Samples 100
Epoch 0 Update 3390 Cost 27.144031659 Time 115025.689459 Samples 100
Epoch 0 Update 3395 Cost 28.9569850486 Time 115028.242616 Samples 100
Epoch 0 Update 3400 Cost 35.9288944699 Time 115030.661467 Samples 100
Epoch 0 Update 3405 Cost 25.5156098908 Time 115032.670153 Samples 100
Epoch 0 Update 3410 Cost 27.4841139828 Time 115034.331742 Samples 100
Epoch 0 Update 3415 Cost 26.1361022047 Time 115036.141863 Samples 100
Epoch 0 Update 3420 Cost 28.9122772973 Time 115038.058705 Samples 100
Epoch 0 Update 3425 Cost 27.6163619422 Time 115040.174363 Samples 100
Epoch 0 Update 3430 Cost 22.0868882276 Time 115042.508705 Samples 100
Epoch 0 Update 3435 Cost 35.6151819635 Time 115045.112016 Samples 100
Epoch 0 Update 3440 Cost 24.770677311 Time 115047.238597 Samples 100
Epoch 0 Update 3445 Cost 30.1627738653 Time 115049.125035 Samples 100
Epoch 0 Update 3450 Cost 33.093788427 Time 115050.775126 Samples 100
Epoch 0 Update 3455 Cost 27.5635207696 Time 115053.099264 Samples 100
Epoch 0 Update 3460 Cost 21.5128954177 Time 115054.97046 Samples 100
Epoch 0 Update 3465 Cost 21.6831393049 Time 115057.19288 Samples 100
Epoch 0 Update 3470 Cost 22.1623901656 Time 115058.963567 Samples 100
Epoch 0 Update 3475 Cost 26.2775924603 Time 115061.144999 Samples 100
Epoch 0 Update 3480 Cost 27.7331125094 Time 115063.5584 Samples 100
Epoch 0 Update 3485 Cost 24.6946916558 Time 115065.63964 Samples 100
Epoch 0 Update 3490 Cost 27.0464592271 Time 115067.614196 Samples 100
Epoch 0 Update 3495 Cost 25.3000234301 Time 115069.770016 Samples 100
Epoch 0 Update 3500 Cost 35.913255082 Time 115072.06785 Samples 100
Epoch 0 Update 3505 Cost 22.876240562 Time 115074.964255 Samples 100
Epoch 0 Update 3510 Cost 18.0351899569 Time 115076.964129 Samples 100
Epoch 0 Update 3515 Cost 20.645520695 Time 115079.174783 Samples 100
Epoch 0 Update 3520 Cost 32.6256144074 Time 115081.348785 Samples 100
Epoch 0 Update 3525 Cost 37.5702824971 Time 115083.576768 Samples 100
Epoch 0 Update 3530 Cost 27.378618045 Time 115085.544956 Samples 100
Epoch 0 Update 3535 Cost 24.1041925273 Time 115087.190398 Samples 100
Epoch 0 Update 3540 Cost 31.4559278955 Time 115088.909197 Samples 100
Epoch 0 Update 3545 Cost 23.1367977003 Time 115091.434819 Samples 100
Epoch 0 Update 3550 Cost 31.7470831465 Time 115093.176016 Samples 100
Epoch 0 Update 3555 Cost 18.8245726793 Time 115094.954173 Samples 100
Epoch 0 Update 3560 Cost 24.1990542009 Time 115096.944306 Samples 100
Epoch 0 Update 3565 Cost 24.8400954625 Time 115099.015542 Samples 100
Epoch 0 Update 3570 Cost 34.7719386623 Time 115101.176755 Samples 100
Epoch 0 Update 3575 Cost 29.5432123527 Time 115102.875095 Samples 100
Epoch 0 Update 3580 Cost 22.9722819719 Time 115104.791865 Samples 100
Epoch 0 Update 3585 Cost 28.3605099927 Time 115106.735933 Samples 100
Epoch 0 Update 3590 Cost 33.6094950752 Time 115108.786137 Samples 100
Epoch 0 Update 3595 Cost 27.1846229467 Time 115110.742923 Samples 100
Saving...
Epoch 1
change = 0.0404713353524
Epoch 1 Update 3600 Cost 14.6220351123 Time 1.83307290077 Samples 100
Epoch 1 Update 3605 Cost 17.7264774936 Time 3.90464305878 Samples 100
Epoch 1 Update 3610 Cost 18.1527377616 Time 6.15237998962 Samples 100
Epoch 1 Update 3615 Cost 10.4078556632 Time 7.95004987717 Samples 100
Epoch 1 Update 3620 Cost 16.8585575242 Time 9.82487607002 Samples 100
Epoch 1 Update 3625 Cost 22.7524105987 Time 12.8378219604 Samples 100
Epoch 1 Update 3630 Cost 15.9921684933 Time 14.6266379356 Samples 100
Epoch 1 Update 3635 Cost 15.7260724251 Time 16.5578758717 Samples 100
Epoch 1 Update 3640 Cost 25.5349527463 Time 18.5219190121 Samples 100
Epoch 1 Update 3645 Cost 26.5475277156 Time 20.3833608627 Samples 100
Epoch 1 Update 3650 Cost 21.5323086568 Time 22.7506780624 Samples 100
Epoch 1 Update 3655 Cost 14.4064754015 Time 25.363286972 Samples 100
Epoch 1 Update 3660 Cost 17.7403448199 Time 27.4616189003 Samples 100
Epoch 1 Update 3665 Cost 23.8226578406 Time 29.669878006 Samples 100
Epoch 1 Update 3670 Cost 21.8294825376 Time 32.2871630192 Samples 100
Epoch 1 Update 3675 Cost 16.808264684 Time 34.2879369259 Samples 100
Epoch 1 Update 3680 Cost 22.9273783119 Time 36.010035038 Samples 100
Epoch 1 Update 3685 Cost 12.7715925852 Time 37.5352699757 Samples 100
Epoch 1 Update 3690 Cost 20.3658692814 Time 40.2528948784 Samples 100
Epoch 1 Update 3695 Cost 19.5531246831 Time 42.1979749203 Samples 100
Epoch 1 Update 3700 Cost 17.4760526845 Time 44.1206150055 Samples 100
Epoch 1 Update 3705 Cost 20.6550328794 Time 46.047672987 Samples 100
Epoch 1 Update 3710 Cost 22.60622337 Time 47.796186924 Samples 100
Epoch 1 Update 3715 Cost 16.5769119723 Time 49.658714056 Samples 100
Epoch 1 Update 3720 Cost 19.4734578627 Time 51.6716599464 Samples 100
Epoch 1 Update 3725 Cost 14.5368448642 Time 53.8852720261 Samples 100
Epoch 1 Update 3730 Cost 13.8565145269 Time 56.2399299145 Samples 100
Epoch 1 Update 3735 Cost 17.6129249109 Time 58.4213519096 Samples 100
Epoch 1 Update 3740 Cost 28.7786176382 Time 60.8983709812 Samples 100
Epoch 1 Update 3745 Cost 17.8694568058 Time 62.6061220169 Samples 100
Epoch 1 Update 3750 Cost 16.6533321516 Time 65.0737688541 Samples 100
Epoch 1 Update 3755 Cost 22.5702962366 Time 66.9720489979 Samples 100
Epoch 1 Update 3760 Cost 18.203678085 Time 69.3559298515 Samples 100
Epoch 1 Update 3765 Cost 20.3217107084 Time 71.0154669285 Samples 100
Epoch 1 Update 3770 Cost 22.6976140723 Time 73.3356890678 Samples 100
Epoch 1 Update 3775 Cost 20.2558996777 Time 75.5118889809 Samples 100
Epoch 1 Update 3780 Cost 16.5965460296 Time 77.687486887 Samples 100
Epoch 1 Update 3785 Cost 18.0634797557 Time 79.9406490326 Samples 100
Epoch 1 Update 3790 Cost 15.0369060784 Time 82.4170558453 Samples 100
Epoch 1 Update 3795 Cost 21.4759806073 Time 85.0768139362 Samples 100
Epoch 1 Update 3800 Cost 21.8122931154 Time 87.1052348614 Samples 100
Epoch 1 Update 3805 Cost 13.1150026982 Time 89.1331410408 Samples 100
Epoch 1 Update 3810 Cost 18.8529705602 Time 91.8408658504 Samples 100
Epoch 1 Update 3815 Cost 19.1401256954 Time 94.0549888611 Samples 100
Epoch 1 Update 3820 Cost 19.3451379876 Time 96.0898840427 Samples 100
Epoch 1 Update 3825 Cost 15.8390795652 Time 98.3012039661 Samples 100
Epoch 1 Update 3830 Cost 18.9694532669 Time 100.165336847 Samples 100
Epoch 1 Update 3835 Cost 19.7759094755 Time 102.241636038 Samples 100
Epoch 1 Update 3840 Cost 20.1668222122 Time 104.055140972 Samples 100
Epoch 1 Update 3845 Cost 16.072491263 Time 106.545393944 Samples 100
Epoch 1 Update 3850 Cost 11.7636440311 Time 108.67383194 Samples 100
Epoch 1 Update 3855 Cost 23.9795313252 Time 110.983206987 Samples 100
Epoch 1 Update 3860 Cost 22.2001164818 Time 113.206336021 Samples 100
Epoch 1 Update 3865 Cost 11.2699078485 Time 115.331871033 Samples 100
Epoch 1 Update 3870 Cost 20.0646166556 Time 117.556527853 Samples 100
Epoch 1 Update 3875 Cost 24.6651809358 Time 119.610399008 Samples 100
Epoch 1 Update 3880 Cost 19.5404533205 Time 121.862184048 Samples 100
Epoch 1 Update 3885 Cost 20.3939101507 Time 123.572032928 Samples 100
Epoch 1 Update 3890 Cost 12.9304002264 Time 125.672426939 Samples 100
Epoch 1 Update 3895 Cost 21.8908986447 Time 127.57218504 Samples 100
Epoch 1 Update 3900 Cost 11.2590563714 Time 129.834693909 Samples 100
Epoch 1 Update 3905 Cost 16.1329353907 Time 131.684025049 Samples 100
Epoch 1 Update 3910 Cost 13.291062303 Time 133.953794956 Samples 100
Epoch 1 Update 3915 Cost 17.7000928209 Time 136.386755943 Samples 100
Epoch 1 Update 3920 Cost 16.0375587307 Time 138.245987892 Samples 100
Epoch 1 Update 3925 Cost 27.5123691457 Time 140.135042906 Samples 100
Epoch 1 Update 3930 Cost 15.069353627 Time 142.234829903 Samples 100
Epoch 1 Update 3935 Cost 17.9662762066 Time 144.369888067 Samples 100
Epoch 1 Update 3940 Cost 19.0529693243 Time 146.545170069 Samples 100
Epoch 1 Update 3945 Cost 14.5125304698 Time 148.913482904 Samples 100
Epoch 1 Update 3950 Cost 21.1030064829 Time 150.739322901 Samples 100
Epoch 1 Update 3955 Cost 13.7342801637 Time 152.92214489 Samples 100
Epoch 1 Update 3960 Cost 18.3329017885 Time 155.515219927 Samples 100
Epoch 1 Update 3965 Cost 17.5346414683 Time 157.177367926 Samples 100
Epoch 1 Update 3970 Cost 18.6410921904 Time 158.923676014 Samples 100
Epoch 1 Update 3975 Cost 23.1651933608 Time 161.364001989 Samples 100
Epoch 1 Update 3980 Cost 21.1091492606 Time 163.235242844 Samples 100
Epoch 1 Update 3985 Cost 16.9590230705 Time 165.011404037 Samples 100
Epoch 1 Update 3990 Cost 25.5316782154 Time 167.325296879 Samples 100
Epoch 1 Update 3995 Cost 16.513118033 Time 169.26275897 Samples 100
Epoch 1 Update 4000 Cost 20.4649794554 Time 171.483263969 Samples 100
Saving...
Testing on Validation set...
####### NEW BEST VALID #######
Epoch 1 Update 4000 Training Cost 18.2246543646 Validation mean rank 20715.1855987 Validation hit@10 26.5561275657% Validation hit@1 19.9037240088%
                                               Testing mean rank 20939.3957837 Testing hit@10 26.4311546264% Testing hit@1 19.7142101085%
Epoch 1 Update 4005 Cost 18.0826189778 Time 38953.8996251 Samples 100
Epoch 1 Update 4010 Cost 16.8908386268 Time 38955.6569309 Samples 100
Epoch 1 Update 4015 Cost 19.078889512 Time 38957.3800619 Samples 100
Epoch 1 Update 4020 Cost 16.1959967616 Time 38959.434675 Samples 100
Epoch 1 Update 4025 Cost 16.7399313097 Time 38961.332773 Samples 100
Epoch 1 Update 4030 Cost 19.1689617343 Time 38962.9436519 Samples 100
Epoch 1 Update 4035 Cost 18.6821261125 Time 38964.731853 Samples 100
Epoch 1 Update 4040 Cost 20.9831509259 Time 38966.6356959 Samples 100
Epoch 1 Update 4045 Cost 17.2936098981 Time 38968.305325 Samples 100
Epoch 1 Update 4050 Cost 16.590346382 Time 38969.896384 Samples 100
Epoch 1 Update 4055 Cost 13.5109684053 Time 38971.7952859 Samples 100
Epoch 1 Update 4060 Cost 19.3156494967 Time 38973.697082 Samples 100
Epoch 1 Update 4065 Cost 12.7744899056 Time 38975.544121 Samples 100
Epoch 1 Update 4070 Cost 15.7187128563 Time 38977.9466929 Samples 100
Epoch 1 Update 4075 Cost 12.7934322285 Time 38980.170449 Samples 100
Epoch 1 Update 4080 Cost 23.8539187714 Time 38982.37954 Samples 100
Epoch 1 Update 4085 Cost 18.0566054519 Time 38984.3240349 Samples 100
Epoch 1 Update 4090 Cost 12.9058813534 Time 38986.3118079 Samples 100
Epoch 1 Update 4095 Cost 19.4909102284 Time 38987.966315 Samples 100
Epoch 1 Update 4100 Cost 16.0367115798 Time 38989.943799 Samples 100
Epoch 1 Update 4105 Cost 17.6921793575 Time 38992.007468 Samples 100
Epoch 1 Update 4110 Cost 21.7780586831 Time 38993.877296 Samples 100
Epoch 1 Update 4115 Cost 22.3772805862 Time 38995.637408 Samples 100
Epoch 1 Update 4120 Cost 13.6081019678 Time 38997.736095 Samples 100
Epoch 1 Update 4125 Cost 13.2475106522 Time 38999.652822 Samples 100
Epoch 1 Update 4130 Cost 18.8706699124 Time 39001.9990449 Samples 100
Epoch 1 Update 4135 Cost 13.0765851568 Time 39004.03968 Samples 100
Epoch 1 Update 4140 Cost 17.1912168762 Time 39006.2344038 Samples 100
Epoch 1 Update 4145 Cost 16.654237697 Time 39008.33657 Samples 100
Epoch 1 Update 4150 Cost 20.6966633962 Time 39010.2856328 Samples 100
Epoch 1 Update 4155 Cost 15.7190188858 Time 39012.5334918 Samples 100
Epoch 1 Update 4160 Cost 16.3941706384 Time 39014.594322 Samples 100
Epoch 1 Update 4165 Cost 23.3999355733 Time 39016.4085219 Samples 100
Epoch 1 Update 4170 Cost 19.0931493635 Time 39018.383821 Samples 100
Epoch 1 Update 4175 Cost 23.863853256 Time 39020.3611031 Samples 100
Epoch 1 Update 4180 Cost 9.31613222328 Time 39022.6317759 Samples 100
Epoch 1 Update 4185 Cost 13.2656203227 Time 39024.4654729 Samples 100
Epoch 1 Update 4190 Cost 14.7491136985 Time 39026.8496768 Samples 100
Epoch 1 Update 4195 Cost 20.4693586909 Time 39029.28298 Samples 100
Epoch 1 Update 4200 Cost 16.1068147732 Time 39031.104337 Samples 100
Epoch 1 Update 4205 Cost 16.6325826078 Time 39033.452951 Samples 100
Epoch 1 Update 4210 Cost 18.8530005406 Time 39035.4838519 Samples 100
Epoch 1 Update 4215 Cost 14.12073009 Time 39038.086266 Samples 100
Epoch 1 Update 4220 Cost 13.1446907707 Time 39039.8596539 Samples 100
Epoch 1 Update 4225 Cost 14.7393069556 Time 39041.5030069 Samples 100
Epoch 1 Update 4230 Cost 19.3682783074 Time 39043.7937939 Samples 100
Epoch 1 Update 4235 Cost 16.3648166377 Time 39046.0310509 Samples 100
Epoch 1 Update 4240 Cost 13.3375566846 Time 39048.0662649 Samples 100
Epoch 1 Update 4245 Cost 16.9704184955 Time 39050.2534709 Samples 100
Epoch 1 Update 4250 Cost 16.2937240266 Time 39052.2204571 Samples 100
Epoch 1 Update 4255 Cost 17.1508644181 Time 39054.1313441 Samples 100
Epoch 1 Update 4260 Cost 15.5245820349 Time 39056.2524109 Samples 100
Epoch 1 Update 4265 Cost 27.494993578 Time 39058.3886321 Samples 100
Epoch 1 Update 4270 Cost 16.3787666919 Time 39060.1648259 Samples 100
Epoch 1 Update 4275 Cost 23.1662318547 Time 39062.0348179 Samples 100
Epoch 1 Update 4280 Cost 10.7044636421 Time 39064.558517 Samples 100
Epoch 1 Update 4285 Cost 19.178525576 Time 39066.681839 Samples 100
Epoch 1 Update 4290 Cost 12.9129651714 Time 39069.1633899 Samples 100
Epoch 1 Update 4295 Cost 14.1302277651 Time 39071.5441549 Samples 100
Epoch 1 Update 4300 Cost 20.3768433294 Time 39073.6664019 Samples 100
Epoch 1 Update 4305 Cost 18.3405331136 Time 39075.83991 Samples 100
Epoch 1 Update 4310 Cost 21.1628714214 Time 39077.930521 Samples 100
Epoch 1 Update 4315 Cost 12.6211718777 Time 39080.0218449 Samples 100
Epoch 1 Update 4320 Cost 17.2560267305 Time 39082.1754451 Samples 100
Epoch 1 Update 4325 Cost 18.3351493061 Time 39084.0900559 Samples 100
Epoch 1 Update 4330 Cost 16.177960276 Time 39085.8719599 Samples 100
Epoch 1 Update 4335 Cost 22.1353880402 Time 39088.28792 Samples 100
Epoch 1 Update 4340 Cost 19.939081787 Time 39090.0772951 Samples 100
Epoch 1 Update 4345 Cost 12.4202919862 Time 39092.0028019 Samples 100
Epoch 1 Update 4350 Cost 18.8216024132 Time 39094.1525109 Samples 100
Epoch 1 Update 4355 Cost 18.8886213277 Time 39096.0969799 Samples 100
Epoch 1 Update 4360 Cost 20.5347335354 Time 39098.3423769 Samples 100
Epoch 1 Update 4365 Cost 18.4645915304 Time 39100.1955779 Samples 100
Epoch 1 Update 4370 Cost 15.0470075298 Time 39102.0376709 Samples 100
Epoch 1 Update 4375 Cost 16.0031931834 Time 39104.172941 Samples 100
Epoch 1 Update 4380 Cost 12.6454255952 Time 39106.1429029 Samples 100
Epoch 1 Update 4385 Cost 19.1808191195 Time 39108.1660569 Samples 100
Epoch 1 Update 4390 Cost 11.9331020293 Time 39110.0578289 Samples 100
Epoch 1 Update 4395 Cost 23.9934717759 Time 39112.1949639 Samples 100
Epoch 1 Update 4400 Cost 24.715397774 Time 39114.136646 Samples 100
Epoch 1 Update 4405 Cost 15.2612037586 Time 39115.9652879 Samples 100
Epoch 1 Update 4410 Cost 21.3910149085 Time 39118.239346 Samples 100
Epoch 1 Update 4415 Cost 15.8598829836 Time 39120.079221 Samples 100
Epoch 1 Update 4420 Cost 11.055139583 Time 39122.7645659 Samples 100
Epoch 1 Update 4425 Cost 9.97955186757 Time 39125.2596431 Samples 100
Epoch 1 Update 4430 Cost 16.6247669263 Time 39127.155771 Samples 100
Epoch 1 Update 4435 Cost 13.0019934697 Time 39129.2502949 Samples 100
Epoch 1 Update 4440 Cost 21.7755342715 Time 39131.3329709 Samples 100
Epoch 1 Update 4445 Cost 23.5501035303 Time 39133.1666338 Samples 100
Epoch 1 Update 4450 Cost 14.6254856722 Time 39135.3517599 Samples 100
Epoch 1 Update 4455 Cost 15.9466201881 Time 39137.463865 Samples 100
Epoch 1 Update 4460 Cost 20.6323713375 Time 39139.4831769 Samples 100
Epoch 1 Update 4465 Cost 21.1883058648 Time 39142.2634289 Samples 100
Epoch 1 Update 4470 Cost 12.3520494852 Time 39144.4376199 Samples 100
Epoch 1 Update 4475 Cost 15.9893749649 Time 39146.494292 Samples 100
Epoch 1 Update 4480 Cost 13.5331633953 Time 39148.649174 Samples 100
Epoch 1 Update 4485 Cost 18.9830649237 Time 39150.1988089 Samples 100
Epoch 1 Update 4490 Cost 17.6203214436 Time 39151.96696 Samples 100
Epoch 1 Update 4495 Cost 15.6712920918 Time 39153.915468 Samples 100
Epoch 1 Update 4500 Cost 18.8841509958 Time 39155.384053 Samples 100
Epoch 1 Update 4505 Cost 12.8302438067 Time 39157.466054 Samples 100
Epoch 1 Update 4510 Cost 12.8006747783 Time 39159.4542921 Samples 100
Epoch 1 Update 4515 Cost 15.8784053278 Time 39162.072829 Samples 100
Epoch 1 Update 4520 Cost 19.7181019827 Time 39163.9040968 Samples 100
Epoch 1 Update 4525 Cost 16.3907851243 Time 39165.4754241 Samples 100
Epoch 1 Update 4530 Cost 9.93242590255 Time 39168.222142 Samples 100
Epoch 1 Update 4535 Cost 14.0410995719 Time 39169.7041769 Samples 100
Epoch 1 Update 4540 Cost 22.6122728459 Time 39171.31779 Samples 100
Epoch 1 Update 4545 Cost 21.9135386613 Time 39173.414341 Samples 100
Epoch 1 Update 4550 Cost 11.5754319593 Time 39175.5355029 Samples 100
Epoch 1 Update 4555 Cost 24.1778592768 Time 39177.3447139 Samples 100
Epoch 1 Update 4560 Cost 20.4094189468 Time 39179.207536 Samples 100
Epoch 1 Update 4565 Cost 21.3516326112 Time 39181.5493319 Samples 100
Epoch 1 Update 4570 Cost 21.7594440525 Time 39183.370414 Samples 100
Epoch 1 Update 4575 Cost 25.9696724447 Time 39185.450444 Samples 100
Epoch 1 Update 4580 Cost 12.5661804586 Time 39187.584403 Samples 100
Epoch 1 Update 4585 Cost 17.8694729082 Time 39189.1929889 Samples 100
Epoch 1 Update 4590 Cost 17.6330537207 Time 39191.566442 Samples 100
Epoch 1 Update 4595 Cost 14.8706076883 Time 39193.52637 Samples 100
Epoch 1 Update 4600 Cost 23.585196339 Time 39195.359817 Samples 100
Epoch 1 Update 4605 Cost 18.8145424089 Time 39197.212034 Samples 100
Epoch 1 Update 4610 Cost 19.0733150186 Time 39198.9146919 Samples 100
Epoch 1 Update 4615 Cost 18.5804301263 Time 39200.89482 Samples 100
Epoch 1 Update 4620 Cost 10.5934781891 Time 39202.671684 Samples 100
Epoch 1 Update 4625 Cost 18.5583987169 Time 39204.6576769 Samples 100
Epoch 1 Update 4630 Cost 14.4042848913 Time 39206.8676701 Samples 100
Epoch 1 Update 4635 Cost 20.0576277255 Time 39208.9253209 Samples 100
Epoch 1 Update 4640 Cost 21.8889480072 Time 39210.8378739 Samples 100
Epoch 1 Update 4645 Cost 12.2900900475 Time 39212.898494 Samples 100
Epoch 1 Update 4650 Cost 16.6076706237 Time 39215.286442 Samples 100
Epoch 1 Update 4655 Cost 16.6381275717 Time 39217.7866459 Samples 100
Epoch 1 Update 4660 Cost 20.17131285 Time 39219.427593 Samples 100
Epoch 1 Update 4665 Cost 19.0344351874 Time 39221.4104829 Samples 100
Epoch 1 Update 4670 Cost 16.9651318069 Time 39223.5203459 Samples 100
Epoch 1 Update 4675 Cost 17.4607111376 Time 39226.060849 Samples 100
Epoch 1 Update 4680 Cost 11.8320990829 Time 39227.8106399 Samples 100
Epoch 1 Update 4685 Cost 16.0357449953 Time 39230.272043 Samples 100
Epoch 1 Update 4690 Cost 13.1221171659 Time 39232.0470419 Samples 100
Epoch 1 Update 4695 Cost 13.6528284465 Time 39234.0954258 Samples 100
Epoch 1 Update 4700 Cost 18.0165887052 Time 39236.338938 Samples 100
Epoch 1 Update 4705 Cost 14.4784198177 Time 39238.292062 Samples 100
Epoch 1 Update 4710 Cost 16.6784709139 Time 39240.330368 Samples 100
Epoch 1 Update 4715 Cost 20.6944078623 Time 39242.7452281 Samples 100
Epoch 1 Update 4720 Cost 17.580671651 Time 39245.1763771 Samples 100
Epoch 1 Update 4725 Cost 17.6458758253 Time 39247.246628 Samples 100
Epoch 1 Update 4730 Cost 13.9803483523 Time 39249.144851 Samples 100
Epoch 1 Update 4735 Cost 19.7844722183 Time 39251.2709451 Samples 100
Epoch 1 Update 4740 Cost 15.2983236686 Time 39253.390801 Samples 100
Epoch 1 Update 4745 Cost 20.7407130612 Time 39255.927393 Samples 100
Epoch 1 Update 4750 Cost 22.2072201896 Time 39257.9982829 Samples 100
Epoch 1 Update 4755 Cost 28.342328012 Time 39259.9056721 Samples 100
Epoch 1 Update 4760 Cost 22.0098090452 Time 39262.0632191 Samples 100
Epoch 1 Update 4765 Cost 15.1199691263 Time 39264.6549239 Samples 100
Epoch 1 Update 4770 Cost 9.83963867276 Time 39266.902627 Samples 100
Epoch 1 Update 4775 Cost 13.6296024085 Time 39268.947706 Samples 100
Epoch 1 Update 4780 Cost 10.938167232 Time 39271.1450529 Samples 100
Epoch 1 Update 4785 Cost 21.6865132402 Time 39273.1243351 Samples 100
Epoch 1 Update 4790 Cost 18.9216163805 Time 39275.7557349 Samples 100
Epoch 1 Update 4795 Cost 19.5084180614 Time 39278.5039959 Samples 100
Epoch 1 Update 4800 Cost 16.6992159138 Time 39280.7119451 Samples 100
Epoch 1 Update 4805 Cost 19.8088416019 Time 39282.584532 Samples 100
Epoch 1 Update 4810 Cost 19.7961853622 Time 39284.8017049 Samples 100
Epoch 1 Update 4815 Cost 25.5712636141 Time 39286.5451539 Samples 100
Epoch 1 Update 4820 Cost 13.3324875191 Time 39288.4414871 Samples 100
Epoch 1 Update 4825 Cost 14.140045112 Time 39290.4707959 Samples 100
Epoch 1 Update 4830 Cost 20.3574163897 Time 39292.7970669 Samples 100
Epoch 1 Update 4835 Cost 21.1839700723 Time 39294.860534 Samples 100
Epoch 1 Update 4840 Cost 15.7702440322 Time 39297.2815669 Samples 100
Epoch 1 Update 4845 Cost 14.8439432266 Time 39299.377306 Samples 100
Epoch 1 Update 4850 Cost 18.8662708989 Time 39301.771327 Samples 100
Epoch 1 Update 4855 Cost 13.8657662225 Time 39304.238631 Samples 100
Epoch 1 Update 4860 Cost 14.0184084004 Time 39306.3810101 Samples 100
Epoch 1 Update 4865 Cost 18.7167481565 Time 39308.400111 Samples 100
Epoch 1 Update 4870 Cost 15.5905883582 Time 39310.028451 Samples 100
Epoch 1 Update 4875 Cost 22.7169785867 Time 39312.1859 Samples 100
Epoch 1 Update 4880 Cost 12.0346643915 Time 39313.9109731 Samples 100
Epoch 1 Update 4885 Cost 15.5259457763 Time 39315.867449 Samples 100
Epoch 1 Update 4890 Cost 19.4484081704 Time 39317.8185489 Samples 100
Epoch 1 Update 4895 Cost 22.2818939927 Time 39319.7729559 Samples 100
Epoch 1 Update 4900 Cost 19.5523085308 Time 39321.9380009 Samples 100
Epoch 1 Update 4905 Cost 26.3380951986 Time 39324.230567 Samples 100
Epoch 1 Update 4910 Cost 14.5842861923 Time 39326.362736 Samples 100
Epoch 1 Update 4915 Cost 13.